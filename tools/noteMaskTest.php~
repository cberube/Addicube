<?php

/*
Snnnnnnn

VVVV pppG GGnn nPPP

F    E

S: 1 = silence, 0 = notes
nnnnnnn: Number of notes
*/

$pitchShift = 0;
$lengthShift = 3;
$groupShift = 6;
$panShift = 9;
$volumnShift = 12;

$pitchMask = 0x7;
$lengthMask = 0x7 << $lengthShift;
$groupMask = 0x7 << $groupShift;
$panMask = 0x7 << $panShift;
$volumnMask = 0xF << $volumnShift;

$format = "%1$016b" . PHP_EOL; 
$valueFormat = '%1$016b = %1$3d (%2$s)' . PHP_EOL; 

/*
printf($format, $pitchMask);
printf($format, $lengthMask);
printf($format, $groupMask);
printf($format, $panMask);
printf($format, $volumnMask);
*/

$groups = array('a', 'b', 'g', 't');
$lengths = array('1', '2', '4', '8', '16', '32');
$pitches = array('0', '1', '2', '3', '4', '5');

$inits = array();

foreach($groups as $g => $group)
{
	foreach($lengths as $l => $length)
	{
		foreach($pitches as $p => $pitch)
		{	
			$value =
				($g << $groupShift & $groupMask) |
				($l << $lengthShift & $lengthMask) |
				($p << $pitchShift & $pitchMask)
			;
			
			$fileName = $group . $length . '-' . $pitch . '.mp3';
			$constName = strtoupper($group . '_' . $length . '_' . $pitch);
			
			//printf($valueFormat, $value, $name);
			
			//[Embed(source = '../../../../../assets/audio/notes/b32-5.mp3')]
			//public static const B_32_5 : Class;
			
			$embed = "[Embed(source = '../../../../../assets/audio/notes/$fileName')]";
			$const = "public static const $constName : Class;"; 
			
			$embeds[$embed] = $const;
			$inits[] = "\t\t\t\"$value\": $constName";
		}
	}
}

$initializer = implode(",\n", $inits);

foreach($embeds as $e => $c)
{
	echo "\t\t$e\n";
	echo "\t\t$c\n\n";
}

echo "\t\tprivate var soundMap = {\n";
echo $initializer;
echo "\n\t\t};";
